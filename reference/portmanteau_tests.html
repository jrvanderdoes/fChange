<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><title>Functional Hypothesis Tests for Functional Data — portmanteau_tests • fChange</title><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet"><link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet"><script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Functional Hypothesis Tests for Functional Data — portmanteau_tests"><meta name="description" content="Computes a variety of portmanteau hypothesis tests for functional data in the
form of dfts objects."><meta property="og:description" content="Computes a variety of portmanteau hypothesis tests for functional data in the
form of dfts objects."></head><body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-light" data-bs-theme="light" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">fChange</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">2.1.0</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="active nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-articles" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Articles</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-articles"><li><a class="dropdown-item" href="../articles/Examples.html">Examples</a></li>
    <li><a class="dropdown-item" href="../articles/functionaldata.html">functionaldata</a></li>
  </ul></li>
<li class="nav-item"><a class="nav-link" href="../news/index.html">Changelog</a></li>
      </ul><ul class="navbar-nav"><li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json"></form></li>
      </ul></div>


  </div>
</nav><div class="container template-reference-topic">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">

      <h1>Functional Hypothesis Tests for Functional Data</h1>

      <div class="d-none name"><code>portmanteau_tests.Rd</code></div>
    </div>

    <div class="ref-description section level2">
    <p>Computes a variety of portmanteau hypothesis tests for functional data in the
form of dfts objects.</p>
    </div>

    <div class="section level2">
    <h2 id="ref-usage">Usage<a class="anchor" aria-label="anchor" href="#ref-usage"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">portmanteau_tests</span><span class="op">(</span></span>
<span>  <span class="va">X</span>,</span>
<span>  test <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"variety"</span>, <span class="st">"single"</span>, <span class="st">"multi"</span>, <span class="st">"spectral"</span>, <span class="st">"independence"</span>, <span class="st">"imhof"</span><span class="op">)</span>,</span>
<span>  lag <span class="op">=</span> <span class="fl">5</span>,</span>
<span>  M <span class="op">=</span> <span class="fl">1000</span>,</span>
<span>  method <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"iid"</span>, <span class="st">"bootstrap"</span><span class="op">)</span>,</span>
<span>  kernel <span class="op">=</span> <span class="va">bartlett_kernel</span>,</span>
<span>  block_size <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  bandwidth <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  components <span class="op">=</span> <span class="fl">3</span>,</span>
<span>  resample_blocks <span class="op">=</span> <span class="st">"separate"</span>,</span>
<span>  replace <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  alpha <span class="op">=</span> <span class="fl">0.05</span></span>
<span><span class="op">)</span></span></code></pre></div>
    </div>

    <div class="section level2">
    <h2 id="arguments">Arguments<a class="anchor" aria-label="anchor" href="#arguments"></a></h2>


<dl><dt id="arg-x">X<a class="anchor" aria-label="anchor" href="#arg-x"></a></dt>
<dd><p>A dfts object or data which can be automatically converted to that
format. See <code><a href="dfts.html">dfts()</a></code>.</p></dd>


<dt id="arg-test">test<a class="anchor" aria-label="anchor" href="#arg-test"></a></dt>
<dd><p>A String specifying the hypothesis test. Currently available
tests are: 'variety', 'single-lag', 'multi-lag', 'spectral', 'independence',
and 'imhof'.</p></dd>


<dt id="arg-lag">lag<a class="anchor" aria-label="anchor" href="#arg-lag"></a></dt>
<dd><p>A positive integer to specify the lag, or maximum lag, of
interest. Only used for the "single-lag", "multi-lag", "independence", and
"imhof" tests.</p></dd>


<dt id="arg-m">M<a class="anchor" aria-label="anchor" href="#arg-m"></a></dt>
<dd><p>Numeric to specify the number of Monte-Carlo or resampled
simulations to use for the limiting distributions.</p></dd>


<dt id="arg-method">method<a class="anchor" aria-label="anchor" href="#arg-method"></a></dt>
<dd><p>String indicating the method for the <code>single</code> test,
options include:</p><ul><li><p><strong>iid</strong>: The
hypothesis test will use a strong-white noise assumption (instead of a
weak-white noise assumption).</p></li>
<li><p><strong>resample</strong>: The hypothesis
test is evaluated by approximating the limiting distribution of the test
statistic via a (block) resampling process.</p></li>
</ul><p>Additional methods are forthcoming.</p></dd>


<dt id="arg-kernel">kernel<a class="anchor" aria-label="anchor" href="#arg-kernel"></a></dt>
<dd><p>Kernel function for spectral test or estimation of covariance.</p></dd>


<dt id="arg-block-size">block_size<a class="anchor" aria-label="anchor" href="#arg-block-size"></a></dt>
<dd><p>Numeric to specify block size for resampling tests.</p></dd>


<dt id="arg-bandwidth">bandwidth<a class="anchor" aria-label="anchor" href="#arg-bandwidth"></a></dt>
<dd><p>Numeric for bandwidth of covariance estimation. If left null,
with be defined by \(N^{1 / (2 * \text{KO} + 1)}\) where KO is the order
of the selected kernel.</p></dd>


<dt id="arg-components">components<a class="anchor" aria-label="anchor" href="#arg-components"></a></dt>
<dd><p>Number of functional principal components to use in the
independence test.</p></dd>


<dt id="arg-resample-blocks">resample_blocks<a class="anchor" aria-label="anchor" href="#arg-resample-blocks"></a></dt>
<dd><p>String indicating the type of resample test to use.
Using <code>separate</code> gives blocks which are separate while <code>overlapping</code>
creates overlapping or sliding windows. When <code>blocksize=1</code> then these
will be identical.</p></dd>


<dt id="arg-replace">replace<a class="anchor" aria-label="anchor" href="#arg-replace"></a></dt>
<dd><p>Boolean for using a permutation or bootstrapped statistic when
<code>method='resample'</code>.</p></dd>


<dt id="arg-alpha">alpha<a class="anchor" aria-label="anchor" href="#arg-alpha"></a></dt>
<dd><p>Numeric value for significance in [0,1].</p></dd>

</dl></div>
    <div class="section level2">
    <h2 id="value">Value<a class="anchor" aria-label="anchor" href="#value"></a></h2>
    <p>List with results dependent on the test. In general, returns the pvalue,
statistic, and simulations/quantile.</p>
    </div>
    <div class="section level2">
    <h2 id="details">Details<a class="anchor" aria-label="anchor" href="#details"></a></h2>
    <p>The "single"-lag portmanteau test assesses the significance of
empirical lagged autocovariance operators at a single lag <code>lag</code>.
It tests the null hypothesis that the lag-h autocovariance operator is equal
to 0. The test is designed for stationary functional time-series, and is
valid under conditional heteroscedasticity conditions.</p>
<p>The "multi"-lag portmanteau test assesses the cumulative significance of
empirical lagged autocovariance operators, up to a user-selected maximum lag
<code>lag</code>. It tests the null hypothesis that the first lag-h autocovariance
operators, \(h=1,\dots,lag\), is equal to 0. The test is designed for
stationary functional time-series, and is valid under conditional
heteroscedasticity conditions.</p>
<p>The "spectral" portmanteau test measures the proximity of a functional time
series to a white noise. Comparison is made to the constant spectral
density operator of an uncorrelated series. The test is not for general
white noise series, and may not hold under functional conditionally
heteroscedastic assumptions.</p>
<p>The "independence" portmanteau test measures independence and identical
distribution based lagged cross-variances from dimension reduction using
functional principal components analysis. The test is not for general white
noise series, and may not hold under functional conditionally
heteroscedastic assumptions.</p>
<p>The "imhof" portmanteau test is an analogue of the "single-lag" test. While
the "single-lag" test computes the limiting distribution of the test
statistic via a Welch-Satterthwaite approximation, the "imhof" test directly
computes the coefficients of the quadratic form in normal variables. Hence,
the test is computationally expensive.</p>
    </div>
    <div class="section level2">
    <h2 id="references">References<a class="anchor" aria-label="anchor" href="#references"></a></h2>
    <p>Kim, M., Kokoszka P., &amp; Rice G. (2023) White noise testing for
functional time series. Statist. Surv., 17, 119-168, DOI: 10.1214/23-SS143</p>
<p>Characiejus, V., &amp; Rice, G. (2020). A general white noise test
based on kernel lag-window estimates of the spectral density operator.
Econometrics and Statistics, 13, 175–196.</p>
<p>Kokoszka P., &amp; Rice G., &amp; Shang H.L. (2017). Inference for the
autocovariance of a functional time series under conditional
heteroscedasticity. Journal of Multivariate Analysis, 162, 32-50.</p>
<p>Zhang X. (2016). White noise testing and model diagnostic
checking for functional time series. Journal of Econometrics, 194, 76-95.</p>
<p>Gabrys R., &amp; Kokoszka P. (2007). Portmanteau Test of Independence
for Functional Observations. Journal of the American Statistical Association,
102:480, 1338-1348, DOI: 10.1198/016214507000001111.</p>
<p>Chen W.W. &amp; Deo R.S. (2004). Power transformations to induce
normality and their applications. Journal of the Royal Statistical Society:
Series B (Statistical Methodology), 66, 117-130.</p>
    </div>

    <div class="section level2">
    <h2 id="ref-examples">Examples<a class="anchor" aria-label="anchor" href="#ref-examples"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span><span class="va">b</span> <span class="op">&lt;-</span> <span class="fu"><a href="generate_brownian_motion.html">generate_brownian_motion</a></span><span class="op">(</span><span class="fl">100</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">res0</span> <span class="op">&lt;-</span> <span class="fu">portmanteau_tests</span><span class="op">(</span><span class="va">b</span>, test <span class="op">=</span> <span class="st">'single'</span>, lag <span class="op">=</span> <span class="fl">2</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">res1</span> <span class="op">&lt;-</span> <span class="fu">portmanteau_tests</span><span class="op">(</span><span class="va">b</span>, test <span class="op">=</span> <span class="st">'multi'</span>, lag <span class="op">=</span> <span class="fl">2</span>, alpha <span class="op">=</span> <span class="fl">0.01</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">res2</span> <span class="op">&lt;-</span> <span class="fu">portmanteau_tests</span><span class="op">(</span><span class="va">b</span>, test <span class="op">=</span> <span class="st">'spectral'</span>, kernel <span class="op">=</span> <span class="va">bartlett_kernel</span>,</span></span>
<span class="r-in"><span>                          bandwidth <span class="op">=</span> <span class="cn">NULL</span>, alpha <span class="op">=</span> <span class="fl">0.05</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">res3</span> <span class="op">&lt;-</span> <span class="fu">portmanteau_tests</span><span class="op">(</span><span class="va">b</span>, test <span class="op">=</span> <span class="st">'spectral'</span>, alpha <span class="op">=</span> <span class="fl">0.1</span>,</span></span>
<span class="r-in"><span>                          kernel <span class="op">=</span> <span class="va">parzen_kernel</span>,</span></span>
<span class="r-in"><span>                          bandwidth <span class="op">=</span> <span class="fu"><a href="adaptive_bandwidth.html">adaptive_bandwidth</a></span><span class="op">(</span><span class="va">b</span>, kernel<span class="op">=</span><span class="va">parzen_kernel</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">res4</span> <span class="op">&lt;-</span> <span class="fu">portmanteau_tests</span><span class="op">(</span><span class="va">b</span>, test <span class="op">=</span> <span class="st">'independence'</span>, components <span class="op">=</span> <span class="fl">2</span>, lag <span class="op">=</span> <span class="fl">2</span><span class="op">)</span></span></span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Registered S3 method overwritten by 'quantmod':</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span>   method            from</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span>   as.zoo.data.frame zoo </span>
<span class="r-in"><span><span class="va">res5</span> <span class="op">&lt;-</span> <span class="fu">portmanteau_tests</span><span class="op">(</span><span class="va">b</span>, test <span class="op">=</span> <span class="st">'single'</span>, lag <span class="op">=</span> <span class="fl">1</span>, M <span class="op">=</span> <span class="fl">50</span><span class="op">)</span></span></span>
</code></pre></div>
    </div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside></div>


    <footer><div class="pkgdown-footer-left">
  <p>Developed by Jeremy VanderDoes, Gregory Rice, Martin Wendler.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.2.</p>
</div>

    </footer></div>





  </body></html>

