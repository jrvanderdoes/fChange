<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><title>Compute Functional Hypothesis Tests — portmanteau_tests • fChange</title><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet"><link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet"><script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Compute Functional Hypothesis Tests — portmanteau_tests"><meta name="description" content="Computes a variety of functional portmanteau hypothesis tests. All hypothesis tests in this
package are accessible through this function."><meta property="og:description" content="Computes a variety of functional portmanteau hypothesis tests. All hypothesis tests in this
package are accessible through this function."></head><body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-light" data-bs-theme="light" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">fChange</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">1.0.0</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="active nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-articles" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Articles</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-articles"><li><a class="dropdown-item" href="../articles/Examples.html">Examples</a></li>
    <li><a class="dropdown-item" href="../articles/Simulations.html">Simulations</a></li>
  </ul></li>
<li class="nav-item"><a class="nav-link" href="../news/index.html">Changelog</a></li>
      </ul><ul class="navbar-nav"><li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json"></form></li>
      </ul></div>


  </div>
</nav><div class="container template-reference-topic">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">

      <h1>Compute Functional Hypothesis Tests</h1>

      <div class="d-none name"><code>portmanteau_tests.Rd</code></div>
    </div>

    <div class="ref-description section level2">
    <p>Computes a variety of functional portmanteau hypothesis tests. All hypothesis tests in this
package are accessible through this function.</p>
    </div>

    <div class="section level2">
    <h2 id="ref-usage">Usage<a class="anchor" aria-label="anchor" href="#ref-usage"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">portmanteau_tests</span><span class="op">(</span></span>
<span>  <span class="va">data</span>,</span>
<span>  test <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"variety"</span>, <span class="st">"single-lag"</span>, <span class="st">"multi-lag"</span>, <span class="st">"spectral"</span>, <span class="st">"independence"</span>, <span class="st">"imhof"</span><span class="op">)</span>,</span>
<span>  lag <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  M <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  method <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"iid"</span>, <span class="st">"bootstrap"</span><span class="op">)</span>,</span>
<span>  kernel <span class="op">=</span> <span class="st">"Bartlett"</span>,</span>
<span>  bandwidth <span class="op">=</span> <span class="st">"adaptive"</span>,</span>
<span>  components <span class="op">=</span> <span class="fl">3</span>,</span>
<span>  block_size <span class="op">=</span> <span class="st">"adaptive"</span>,</span>
<span>  moving <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  B <span class="op">=</span> <span class="fl">500</span>,</span>
<span>  alpha <span class="op">=</span> <span class="fl">0.05</span></span>
<span><span class="op">)</span></span></code></pre></div>
    </div>

    <div class="section level2">
    <h2 id="arguments">Arguments<a class="anchor" aria-label="anchor" href="#arguments"></a></h2>


<dl><dt id="arg-data">data<a class="anchor" aria-label="anchor" href="#arg-data"></a></dt>
<dd><p>A dfts object or data which can be automatically converted to that
format. See <code><a href="dfts.html">dfts()</a></code>.</p></dd>


<dt id="arg-test">test<a class="anchor" aria-label="anchor" href="#arg-test"></a></dt>
<dd><p>A String specifying the hypothesis test. Currently available tests are referred to by their
string handles: 'variety', "single-lag", "multi-lag", "spectral", "independence", and "imhof". Please see the Details
section of the documentation, or the vignette, for a short overview of the available tests. For a more
complete treatment of these hypothesis tests, please consult the references.</p></dd>


<dt id="arg-lag">lag<a class="anchor" aria-label="anchor" href="#arg-lag"></a></dt>
<dd><p>A positive integer value. Only used for the "single-lag", "multi-lag", "independence", and "imhof" tests.
This parameter specifies the single lag, or maximum lag, to be used by the specified test.</p></dd>


<dt id="arg-m">M<a class="anchor" aria-label="anchor" href="#arg-m"></a></dt>
<dd><p>Only used for the "single-lag" and "multi-lag" tests. A positive Integer. Determines the number of
Monte-Carlo simulations employed in the Welch-Satterthwaite approximation of the limiting distribution of the
test statistic.</p></dd>


<dt id="arg-method">method<a class="anchor" aria-label="anchor" href="#arg-method"></a></dt>
<dd><p>String indicating the method, options include:</p><ul><li><p><strong>iid</strong>:Only used for the "single-lag" and "multi-lag" tests. The
hypothesis test will use a strong-white noise assumption (instead of a
weak-white noise assumption).</p></li>
<li><p><strong>bootstrap</strong>: Only used for the "single-lag" test. The hypothesis
test is evaluated by approximating the limiting distribution of the test
statistic via a block bootstrapping process.</p></li>
</ul></dd>


<dt id="arg-kernel">kernel<a class="anchor" aria-label="anchor" href="#arg-kernel"></a></dt>
<dd><p>Only used for the "spectral" test. A String, 'Bartlett' by default. Specifies the kernel to be
used in the "spectral" test. Currently supported kernels are the 'Bartlett' and 'Parzen' kernels.</p></dd>


<dt id="arg-bandwidth">bandwidth<a class="anchor" aria-label="anchor" href="#arg-bandwidth"></a></dt>
<dd><p>Only used for the "spectral" test. Either a String or a positive Integer value, 'adaptive' by
default. Determines the bandwidth (or lag-window) to be used for the test. Given the string handle 'adaptive',
the bandwidth is computed via a bandwidth selection method which aims to minimize the integrated normed
error of the spectral density operator. If the given string handle is 'static', the bandwidth is computed
to be n^(1/(2q + 1)), where n is the sample size and q is the kernel order. If a positive integer is
given, that will be the bandwidth that is used.</p></dd>


<dt id="arg-components">components<a class="anchor" aria-label="anchor" href="#arg-components"></a></dt>
<dd><p>Only used for the "independence" test. A positive Integer value. Determines the number of
functional principal components to use (ranked by their importance).</p></dd>


<dt id="arg-block-size">block_size<a class="anchor" aria-label="anchor" href="#arg-block-size"></a></dt>
<dd><p>Only used for the "single-lag" test in the case when 'bootstrap' = TRUE. A positive Integer
value, with the default value being computed via the adaptive bandwidth selection method in the "spectral" test.
Determines the block size (of each block in each bootstrap sample) if the test is being bootstrapped.</p></dd>


<dt id="arg-moving">moving<a class="anchor" aria-label="anchor" href="#arg-moving"></a></dt>
<dd><p>Only used for the "single-lag" test in the case when 'bootstrap' = TRUE. A Boolean value, FALSE
by default If given TRUE, the performed block bootstrap will be moving rather than stationary.</p></dd>


<dt id="arg-b">B<a class="anchor" aria-label="anchor" href="#arg-b"></a></dt>
<dd><p>Only used for the "single-lag" test in the case when 'bootstrap' = TRUE. A positive Integer with
a default value of 300. Determines the number of bootstrap samples to take if the test is being bootstrapped.</p></dd>


<dt id="arg-alpha">alpha<a class="anchor" aria-label="anchor" href="#arg-alpha"></a></dt>
<dd><p>Numeric value between 0 and 1 specifying the significance level to be used in the specified
hypothesis test. The default value is 0.05. Note, the significance value is only ever used to compute the
1-alpha quantile of the limiting distribution of the specified test's test statistic.</p></dd>

</dl></div>
    <div class="section level2">
    <h2 id="value">Value<a class="anchor" aria-label="anchor" href="#value"></a></h2>
    <p>If suppress_raw_output = FALSE, a list containing the test statistic, the 1-alpha quantile of the
limiting distribution, and the p-value computed from the specified hypothesis test. Also prints output
containing a short description of the test, the p-value, and additional information about the test if
suppress_print_output = FALSE. If 'complete-test' = TRUE, will return a 1-column table instead containing
the p-values for a variety of tests, which are given short descriptions in the index of the table.</p>
    </div>
    <div class="section level2">
    <h2 id="details">Details<a class="anchor" aria-label="anchor" href="#details"></a></h2>
    <p>The "single-lag" portmanteau test is based on the sample autocovariance function computed from the
functional data. This test assesses the significance of lagged autocovariance operators at a single, user-specified
lag h. More specifically, it tests the null hypothesis that the lag-h autocovariance operator is equal to 0.
This test is designed for stationary functional time-series, and is valid under conditional heteroscedasticity
conditions.
The required parameter for this test are 'lag', which determines the lag at which the test is evaluated. If this
parameter is left blank, it will take a default of 1.
The optional parameters for this test are 'iid', 'M', 'low_disc', 'bootstrap', 'block_size', 'straps', 'moving',
and 'alpha'.</p>
<p>The "multi-lag" portmanteau test is also based on the sample autocovariance function computed from the functional
data. This test assesses the cumulative significance of lagged autocovariance operators, up to a user-selected
maximum lag lag. More specifically, it tests the null hypothesis that the first lag lag-h autocovariance operators
(h going from 1 to lag) is equal to 0. This test is designed for stationary functional time-series, and is valid
under conditional heteroscedasticity conditions.
The required parameter for this test is 'lag', which determines the maximum lag at which the test is evaluated.
If this parameter is left blank, it will take a default of 20.
The optional parameters for this test are 'iid', 'M', 'low_disc', 'bootstrap', 'block_size', 'straps', 'moving',
and 'alpha'.</p>
<p>The "spectral" portmanteau test is based on the spectral density operator. It essentially measures the proximity of a
functional time series to a white noise - the constant spectral density operator of an uncorrelated series.
Unlike the "single-lag" and "multi-lag" tests, this test is not for general white noise series, and may not hold
under functional conditionally heteroscedastic assumptions.
The optional parameters for this test are 'kernel', 'bandwidth', and 'alpha'.</p>
<p>The "independence" portmanteau test is a test of independence and identical distribution based on a dimensionality
reduction by projecting the data onto the most important functional principal components. It is based on the
resulting lagged cross-variances. This test is not for general white noise series, and may not hold under
functional conditionally heteroscedastic assumptions.
The required parameters for this test are 'lag' and 'components'. The 'lag' parameter determines the maximum lag at
which the test is evaluated. The 'components' parameter determines the number of the most important principal
components to use (importance is determined by the proportion of the variance that is explained by the
individual principal component.)</p>
<p>The "imhof" portmanteau test is an analogue of the "single-lag" test. While the "single-lag" test computes the
limiting distribution of the test statistic via a Welch-Satterthwaite approximation, the "imhof" test directly
computes the coefficients of the quadratic form in Normal variables which the test statistic converges too as
the sample size goes to infinity. We warn the user that this test is extremely computationally expensive, and
is only recommended for small datasets as a means of cross-verification against the single-lag test.
The required parameter for this test is 'lag', which determines the lag at which the test is evaluated.
The "imhof" test requires the "tensorA" and "CompQuadForm" packages. Note also that the imhof test does not
return a statistic, and thus returns a list with only 2 elements if suppress_raw_output = FALSE.</p>
    </div>
    <div class="section level2">
    <h2 id="references">References<a class="anchor" aria-label="anchor" href="#references"></a></h2>
    <p>Kim, M., Kokoszka P., &amp; Rice G. (2023) White noise testing for functional
time series. Statist. Surv., 17, 119-168, DOI: 10.1214/23-SS143</p>
<p>Characiejus V., &amp; Rice G. (2019). A general white noise test based on kernel lag-window estimates of the
spectral density operator. Econometrics and Statistics, submitted.</p>
<p>Kokoszka P., &amp; Rice G., &amp; Shang H.L. (2017). Inference for the autocovariance of a functional time series
under conditional heteroscedasticity. Journal of Multivariate Analysis, 162, 32-50.</p>
<p>Zhang X. (2016). White noise testing and model diagnostic checking for functional time series.
Journal of Econometrics, 194, 76-95.</p>
<p>Gabrys R., &amp; Kokoszka P. (2007). Portmanteau Test of Independence for Functional Observations.
Journal of the American Statistical Association, 102:480, 1338-1348, DOI: 10.1198/016214507000001111.</p>
<p>Chen W.W. &amp; Deo R.S. (2004). Power transformations to induce normality and their applications.
Journal of the Royal Statistical Society: Series B (Statistical Methodology), 66, 117-130.</p>
    </div>

    <div class="section level2">
    <h2 id="ref-examples">Examples<a class="anchor" aria-label="anchor" href="#ref-examples"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span><span class="va">b</span> <span class="op">&lt;-</span> <span class="fu"><a href="generate_brownian_motion.html">generate_brownian_motion</a></span><span class="op">(</span><span class="fl">250</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">res0</span> <span class="op">&lt;-</span> <span class="fu">portmanteau_tests</span><span class="op">(</span><span class="va">b</span>, test <span class="op">=</span> <span class="st">'single-lag'</span>, lag <span class="op">=</span> <span class="fl">10</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">res1</span> <span class="op">&lt;-</span> <span class="fu">portmanteau_tests</span><span class="op">(</span><span class="va">b</span>, test <span class="op">=</span> <span class="st">'multi-lag'</span>, lag <span class="op">=</span> <span class="fl">10</span>, alpha <span class="op">=</span> <span class="fl">0.01</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">res2</span> <span class="op">&lt;-</span> <span class="fu">portmanteau_tests</span><span class="op">(</span><span class="va">b</span>, test <span class="op">=</span> <span class="st">'spectral'</span>, kernel <span class="op">=</span> <span class="st">'Bartlett'</span>,</span></span>
<span class="r-in"><span>                          bandwidth <span class="op">=</span> <span class="st">'static'</span>, alpha <span class="op">=</span> <span class="fl">0.05</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">res3</span> <span class="op">&lt;-</span> <span class="fu">portmanteau_tests</span><span class="op">(</span><span class="va">b</span>, test <span class="op">=</span> <span class="st">'spectral'</span>, alpha <span class="op">=</span> <span class="fl">0.1</span>,</span></span>
<span class="r-in"><span>                          kernel <span class="op">=</span> <span class="st">'Parzen'</span>, bandwidth <span class="op">=</span> <span class="st">'adaptive'</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">res4</span> <span class="op">&lt;-</span> <span class="fu">portmanteau_tests</span><span class="op">(</span><span class="va">b</span>, test <span class="op">=</span> <span class="st">'independence'</span>, components <span class="op">=</span> <span class="fl">3</span>, lag <span class="op">=</span> <span class="fl">3</span><span class="op">)</span></span></span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Registered S3 method overwritten by 'quantmod':</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span>   method            from</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span>   as.zoo.data.frame zoo </span>
<span class="r-in"><span><span class="va">res5</span> <span class="op">&lt;-</span> <span class="fu">portmanteau_tests</span><span class="op">(</span><span class="va">b</span>, test <span class="op">=</span> <span class="st">'single-lag'</span>, lag <span class="op">=</span> <span class="fl">1</span>, M <span class="op">=</span> <span class="fl">250</span><span class="op">)</span></span></span>
</code></pre></div>
    </div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside></div>


    <footer><div class="pkgdown-footer-left">
  <p>Developed by Jeremy VanderDoes, Gregory Rice, Martin Wendler.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.1.</p>
</div>

    </footer></div>





  </body></html>

